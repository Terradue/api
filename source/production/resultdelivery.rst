.. _executionresults:

Execution Result
~~~~~~~~~~~~~~~~

The results of the job should be formatted or defined in a proper way to be then viewed or resused in the platform.

The platform always try to convert the WPS Output to a more advanced result format using the OWS Context specification [#OGCOWC]_. For doing this, it will search for specific output information referencing results metadata.

The platform currently exploits the following information defintion from the most recommended solution to the least one.

OpenSearch interface
""""""""""""""""""""

If the response contains one Output with ``Identifier`` = **result_osd** and a Reference pointing to a compliant :ref:`opensearch` Description Document [#OGCOS]_, that describes query templates to search for the results files of the processing service as a feed represented in a supported :ref:`Metadata model <metadatamodel>`. This solution is used on the Developer Cloud Sandboxes.

.. code-block:: xml

	<?xml version="1.0" encoding="us-ascii"?>
	<wps:Output>
		<ows:Identifier xmlns:ns1="http://www.opengis.net/ows/1.1">result_osd</ows:Identifier>
		<ows:Title xmlns:ns1="http://www.opengis.net/ows/1.1">OpenSearch Description to the Results</ows:Title>
			<wps:Reference href="https://sb-10-16-10-20.dev.terradue.int/sbws/wps/dcs-doris-ifg/0000023-160501000006641-oozie-oozi-W/results/description" mimeType="application/opensearchdescription+xml" />
	</wps:Output> 

or as the Reference in ComplexData

.. code-block:: xml

	<?xml version="1.0" encoding="us-ascii"?>
	<wps:Output>
		<ows:Identifier xmlns:ns1="http://www.opengis.net/ows/1.1">result_osd</ows:Identifier>
		<ows:Title xmlns:ns1="http://www.opengis.net/ows/1.1">OpenSearch Description to the Results</ows:Title>
		<wps:Data>
			<wps:ComplexData mimeType="application/xml">
				<wps:Reference href="http://sb-10-16-10-20.dev.terradue.int/sbws/wps/dcs-doris-ifg/0000023-160501000006641-oozie-oozi-W/results/description" mimeType="application/opensearchdescription+xml" />
			</wps:ComplexData>
		</wps:Data>
	</wps:Output> 


Atom Feed
"""""""""

In case, your processing service cannot provide with an OpenSearch interface, it can provide with the metadata feed directly.

The response should therefore contain one Output with ``Identifier`` = **result_metadata** and a Reference pointing to a metadata file generated by the processing service and describing the results files as an atom feed.

.. code-block:: xml

	<?xml version="1.0" encoding="us-ascii"?>
	<wps:Output>
		<ows:Identifier xmlns:ns1="http://www.opengis.net/ows/1.1">result_metadata</ows:Identifier>
		<ows:Title xmlns:ns1="http://www.opengis.net/ows/1.1">OpenSearch Description to the Results</ows:Title>
			<wps:Reference href="http://sb-10-15-36-17.hydro.terradue.int/wpsoutputs/metadata.xml" method="GET" mimeType="application/atom+xml" />
	</wps:Output> 

or as the Reference in ComplexData

.. code-block:: xml

	<?xml version="1.0" encoding="us-ascii"?>
	<wps:Output>
		<ows:Identifier xmlns:ns1="http://www.opengis.net/ows/1.1">result_metadata</ows:Identifier>
		<ows:Title xmlns:ns1="http://www.opengis.net/ows/1.1">OpenSearch Description to the Results</ows:Title>
		<wps:Data>
			<wps:ComplexData mimeType="application/xml">
				<wps:Reference href="http://sb-10-15-36-17.hydro.terradue.int/wpsoutputs/metadata.xml" method="GET" mimeType="application/atom+xml" />
			</wps:ComplexData>
		</wps:Data>
	</wps:Output> 


or directly in the ComplexData output

example of metadata.xml

.. code-block:: xml

	<?xml version="1.0" encoding="us-ascii"?>
	<wps:Output>
		<ows:Identifier xmlns:ns1="http://www.opengis.net/ows/1.1">result_metadata</ows:Identifier>
		<ows:Title xmlns:ns1="http://www.opengis.net/ows/1.1">OpenSearch Description to the Results</ows:Title>
		<wps:Data>
			<wps:ComplexData mimeType="application/xml">
				<feed xmlns="http://www.w3.org/2005/Atom">
				  <title type="text">Discovery feed for WPS result local data</title>
				  <subtitle type="text">This OpenSearch Service allows the discovery of the different items which are part of the localdata collection. This search service is in accordance with the OGC 10-032r3 specification.</subtitle>
				  <generator>Terradue Web Server</generator>
				  <entry>
				    <id>AATSR_output.png</id>
				    <title type="text">AATSR_output.png</title>
				    <published>2016-06-15T10:27:30.711606Z</published>
				    <updated>2016-06-15T10:27:30.711606Z</updated>
				    <link href="http://sb-10-15-36-17.hydro.terradue.int/wpsoutputs/AATSR_output.png?op=OPEN" rel="enclosure" type="application/octet-stream"/>
				    <identifier xmlns="http://purl.org/dc/elements/1.1/">AATSR_output.png</identifier>
				    <where xmlns="http://www.georss.org/georss/10" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
				      <Polygon xmlns="http://www.opengis.net/gml">
				        <exterior>
				          <LinearRing>
				            <posList srsDimension="2">30.5009918 0.9953687 30.5009918 -4.2681770 35.9339877 -4.2681770 35.9339877 0.9953687 30.5009918 0.9953687</posList>
				          </LinearRing>
				        </exterior>
				      </Polygon>
				    </where>
				    <box xmlns="http://www.georss.org/georss">30.5009918 -4.2681770 35.9339877 0.9953687</box>
				    <offering xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.opengis.net/owc/1.0" code="http://www.opengis.net/spec/owc-atom/1.0/req/png">
				      <content href="http://sb-10-15-36-17.hydro.terradue.int/wpsoutputs/AATSR_output.png?op=OPEN" type="image/png" />
				    </offering>
				  </entry>
				  <entry>
				        <id>http://sb-10-15-36-17/HEP_tests/qgis_outputs/AATSR_output.tif</id>
				    <title type="text">AATSR_output.tif</title>
				        <published>2016-06-15T10:27:30.711606Z</published>
				    <updated>2016-06-15T10:27:30.711606Z</updated>
				    <link href="http://sb-10-15-36-17.hydro.terradue.int/wpsoutputs/AATSR_output.tif?op=OPEN" rel="enclosure" type="application/octet-stream"/>
				    <identifier xmlns="http://purl.org/dc/elements/1.1/">AATSR_output.tif</identifier>
				    <where xmlns="http://www.georss.org/georss/10" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
				      <Polygon xmlns="http://www.opengis.net/gml">
				        <exterior>
				          <LinearRing>
				            <posList srsDimension="2">30.5009918 0.9953687 30.5009918 -4.2681770 35.9339877 -4.2681770 35.9339877 0.9953687 30.5009918 0.9953687</posList>
				          </LinearRing>
				        </exterior>
				      </Polygon>
				    </where>
				    <box xmlns="http://www.georss.org/georss">30.5009918 -4.2681770 35.9339877 0.9953687</box>
				    <offering xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.opengis.net/owc/1.0" code="http://www.opengis.net/spec/owc-atom/1.0/req/png">
				      <content href="http://sb-10-15-36-17.hydro.terradue.int/wpsoutputs/AATSR_output.tif?op=OPEN" type="image/tif" />
				      </offering>
				  </entry>
				  <identifier xmlns="http://purl.org/dc/elements/1.1/">localdata</identifier>
				  <queryTime xmlns="http://purl.org/dc/elements/1.1/">0.0002</queryTime>
				  <startIndex xmlns="http://a9.com/-/spec/opensearch/1.1/">1</startIndex>
				  <itemsPerPage xmlns="http://a9.com/-/spec/opensearch/1.1/">50</itemsPerPage>
				  <os:Query os:count="50" os:language="" os:searchTerms="" os:startIndex="" os:startPage="" xmlns:os="http://a9.com/-/spec/opensearch/1.1/" xmlns:param="http://a9.com/-/spec/opensearch/extensions/parameters/1.0/"/>
				</feed>
			</wps:ComplexData>
		</wps:Data>
	</wps:Output> 


The content
	  

.. rubric:: Footnotes

.. [#OGCOWC] http://www.opengeospatial.org/standards/owc
.. [#OGCOS] http://www.opensearch.org/
